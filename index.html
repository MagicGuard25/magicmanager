<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="icon" href="favicon.ico">
  <title>SmartGuard UI</title>

  <!-- עיצוב לפופאפ ולכפתור חזרה לעמוד הבית -->
  <style>
    #popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    #popup .popup-content {
      background: #fff;
      padding: 20px 30px;
      border-radius: 12px;
      text-align: center;
      max-width: 320px;
      font-family: Arial, sans-serif;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      position: relative;
    }
    #popup .popup-content .emoji {
      font-size: 48px;
      margin-bottom: 10px;
    }
    #popup .popup-content p {
      margin-bottom: 20px;
      font-size: 16px;
      color: #333;
    }
    #popup .popup-content button {
      background-color: #4285f4;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    #popup .popup-content button:hover {
      background-color: #3367d6;
    }
    
    /* עיצוב כפתור חזרה לעמוד הבית */
    .home-button-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      touch-action: none; /* חשוב למובייל */
    }
    
    .home-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 60px;
      height: 60px;
      background-color: #4285f4;
      color: white;
      border: none;
      border-radius: 50%;
      font-size: 24px;
      text-decoration: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
      cursor: move;
    }
    
    .home-button:hover {
      background-color: #3367d6;
      transform: scale(1.1);
      box-shadow: 0 6px 12px rgba(0,0,0,0.4);
    }
  </style>

  <!-- קבצי CSS -->
  <link href="static/css/chunk-vendors.4f0bdeee.css" rel="stylesheet">
  <link href="static/css/app.380a3e9b.css" rel="stylesheet">

  <!-- קובץ תיקון -->
  <script src="direct_fix.js"></script>

  <!-- סקריפט להפניה אוטומטית לכתובת המתורגמת -->
  <script>
    const translatedURL = "https://translate-magickguard-com.translate.goog/home.html?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en-US&_x_tr_hist=true#/";
    const currentURL = window.location.href;

    if (!currentURL.includes("translate-magickguard-com.translate.goog")) {
      console.log('Redirecting to translated version...');
      window.location.href = translatedURL;
    }
  </script>

</head>

<body>

<!-- הפופאפ המעוצב -->
<div id="popup">
  <div class="popup-content">
    <div class="emoji">📢</div>
    <p>Please open this page in Google Chrome and use the browser's built-in translation feature to translate it.<br><br>
    If translation does not start automatically, click on the three dots (menu) ➔ 'Translate'.</p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<noscript>
  <strong>We're sorry but SmartGuard UI doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
</noscript>

<!-- האפליקציה שלך -->
<div id="app"></div>

<!-- כפתור חזרה לעמוד הבית -->
<div class="home-button-container">
  <a href="https://translate.magickguard.com/" class="home-button" id="draggableButton">
    <span>🏠</span>
  </a>
</div>

<!-- סקריפט להזזת הכפתור -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const button = document.getElementById('draggableButton');
    const container = button.parentElement;
    let isDragging = false;
    let currentX;
    let currentY;
    let initialX;
    let initialY;
    let xOffset = 0;
    let yOffset = 0;

    // שמירת מיקום הכפתור בלוקל סטורג'
    const savedPosition = localStorage.getItem('homeButtonPosition');
    if (savedPosition) {
      const position = JSON.parse(savedPosition);
      xOffset = position.x;
      yOffset = position.y;
      setTranslate(xOffset, yOffset, container);
    }

    // פונקציות למגע
    function dragStart(e) {
      if (e.type === "touchstart") {
        initialX = e.touches[0].clientX - xOffset;
        initialY = e.touches[0].clientY - yOffset;
      } else {
        initialX = e.clientX - xOffset;
        initialY = e.clientY - yOffset;
      }

      if (e.target === button || e.target.parentElement === button) {
        isDragging = true;
      }
    }

    function dragEnd(e) {
      initialX = currentX;
      initialY = currentY;
      isDragging = false;
      
      // שמירת המיקום החדש
      localStorage.setItem('homeButtonPosition', JSON.stringify({
        x: xOffset,
        y: yOffset
      }));
    }

    function drag(e) {
      if (isDragging) {
        e.preventDefault();
        
        if (e.type === "touchmove") {
          currentX = e.touches[0].clientX - initialX;
          currentY = e.touches[0].clientY - initialY;
        } else {
          currentX = e.clientX - initialX;
          currentY = e.clientY - initialY;
        }

        xOffset = currentX;
        yOffset = currentY;
        
        // סימון שהייתה תזוזה
        hasMoved = true;
        
        setTranslate(currentX, currentY, container);
      }
    }

    function setTranslate(xPos, yPos, el) {
      el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
    }

    // אירועי מגע
    container.addEventListener("touchstart", dragStart, false);
    container.addEventListener("touchend", dragEnd, false);
    container.addEventListener("touchmove", drag, false);

    // אירועי עכבר
    container.addEventListener("mousedown", dragStart, false);
    container.addEventListener("mouseup", dragEnd, false);
    container.addEventListener("mousemove", drag, false);
    
    // מניעת ניווט בלחיצה על הכפתור בזמן גרירה
    let startTime;
    let hasMoved = false;
    
    button.addEventListener("mousedown", function(e) {
      startTime = new Date().getTime();
      hasMoved = false;
    });
    
    button.addEventListener("mouseup", function(e) {
      const endTime = new Date().getTime();
      const timeDiff = endTime - startTime;
      
      // אם לא הייתה תזוזה משמעותית, זה נחשב לחיצה ולא גרירה
      if (!hasMoved) {
        window.location.href = button.getAttribute('href');
      }
    });
    
    // מניעת ניווט בלחיצה על הכפתור בזמן גרירה במובייל
    button.addEventListener("touchstart", function(e) {
      startTime = new Date().getTime();
      hasMoved = false;
    });
    
    button.addEventListener("touchend", function(e) {
      if (!hasMoved) {
        window.location.href = button.getAttribute('href');
      }
    });
  });
</script>

<!-- קבצי JS -->
<script src="static/js/chunk-vendors.111f4aba.js"></script>
<script src="static/js/app.3e303ad2.js"></script>

<!-- סקריפט לניהול הפופאפ -->
<script>
  function closePopup() {
    document.getElementById('popup').style.display = 'none';
  }

  window.onload = function() {
    setTimeout(function() {
      closePopup();
    }, 5000); // סגירה אוטומטית אחרי 5 שניות
  };
</script>

<!-- סקריפט להסרת הפופאפ של Google Translate -->
<script>
(function() {
  if (window.location.hostname.includes("translate.goog")) {
    const removePopup = () => {
      const popup = document.querySelector('[role="dialog"]');
      if (popup) {
        popup.remove();
        console.log("Google Translate popup removed.");
      }
    };

    // נסה להסיר מיידית
    removePopup();

    // התחברות למעקב אחרי שינויים ב-DOM
    const observer = new MutationObserver(() => {
      removePopup();
    });

    observer.observe(document.body, { childList: true, subtree: true });
  }
})();
</script>

</body>
</html>
